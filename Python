from telegram import Update
from telegram.ext import (
    ApplicationBuilder,
    MessageHandler,
    filters,
    ContextTypes
)
import os

TOKEN = os.environ.get("TOKEN")  # Render wstrzyknie Twój token

async def silent_delete(update: Update, context: ContextTypes.DEFAULT_TYPE):
    try:
        await update.message.delete()
    except:
        pass

async def main():
    app = ApplicationBuilder().token(TOKEN).build()

    system_filters = (
        filters.StatusUpdate.NEW_CHAT_MEMBERS |
        filters.StatusUpdate.LEFT_CHAT_MEMBER |
        filters.StatusUpdate.NEW_CHAT_TITLE |
        filters.StatusUpdate.NEW_CHAT_PHOTO |
        filters.StatusUpdate.DELETE_CHAT_PHOTO |
        filters.StatusUpdate.PINNED_MESSAGE
    )

    app.add_handler(MessageHandler(system_filters, silent_delete))

    print("Stealth bot działa (usuwa logi w tle)")
    await app.run_polling()

if __name__ == "__main__":
    import asyncio
    asyncio.run(main())
